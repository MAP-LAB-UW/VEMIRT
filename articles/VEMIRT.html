<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Variational Estimation for Multidimensional Item Response Theory Using VEMIRT â€¢ VEMIRT</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Variational Estimation for Multidimensional Item Response Theory Using VEMIRT">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">VEMIRT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/VEMIRT-package.html">Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/VEMIRT.html">Tutorial</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Glossary</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MAP-LAB-UW/VEMIRT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Variational Estimation for Multidimensional Item Response Theory Using VEMIRT</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MAP-LAB-UW/VEMIRT/blob/master/vignettes/VEMIRT.Rmd" class="external-link"><code>vignettes/VEMIRT.Rmd</code></a></small>
      <div class="d-none name"><code>VEMIRT.Rmd</code></div>
    </div>

    
    
<!-- Run knitr::knit("VEMIRT.Rmd.orig", output = "VEMIRT.Rmd") to prebuild the vignette -->
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this tutorial, we illustrate how to conduct multidimensional item
response theory (MIRT) analysis of multidimensional two parameter
logistic (M2PL) and multidimensional three parameter logistic (M3PL)
models, and differential item functioning (DIF) analysis of M2PL models
using the <code>VEMIRT</code> package in <code>R</code>, which can be
installed with</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"MAP-LAB-UW/VEMIRT"</span>, build_vignettes <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu">torch</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/torch/man/install_torch.html" class="external-link">install_torch</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The package requires a C++ compiler to work properly, and users are
referred to <a href="https://github.com/MAP-LAB-UW/VEMIRT" class="external-link uri">https://github.com/MAP-LAB-UW/VEMIRT</a> for more
information.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://MAP-LAB-UW.github.io/VEMIRT">VEMIRT</a></span><span class="op">)</span></span></code></pre></div>
<p>Most functions are based on the Gaussian variational
expectation-maximization (GVEM) algorithm, which is applicable for
high-dimensional latent traits.</p>
</div>
<div class="section level2">
<h2 id="data-input">Data Input<a class="anchor" aria-label="anchor" href="#data-input"></a>
</h2>
<p>Data required for analysis are summarized below:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="center">Analysis</th>
<th align="center">Item Responses</th>
<th align="center">Loading Indicator</th>
<th align="center">Group Membership</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Exploratory Factor Analysis</td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">Confirmatory Factor Analysis</td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">Differential Item Functioning</td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center"><span class="math inline">\checkmark</span></td>
<td align="center"><span class="math inline">\checkmark</span></td>
</tr>
</tbody>
</table>
<p>Here we take dataset <code>D2PL_data</code> as an example. This
simulated dataset is for DIF 2PL analysis. Responses should be an <span class="math inline">N</span> by <span class="math inline">J</span>
binary matrix, where <span class="math inline">N</span> and <span class="math inline">J</span> are the numbers of respondents and items
respectively. Currently, DIF functions allow responses to have missing
data, which should be coded as <code>NA</code>. In this example, there
are <span class="math inline">N=1500</span> respondents and <span class="math inline">J=20</span> items.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">D2PL_data</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19]</span></span>
<span><span class="co">#&gt; [1,]    0    1    0    1    1    0    1    0    0     0     1     0     0     1     0     1     1     1     1</span></span>
<span><span class="co">#&gt; [2,]    0    0    0    0    1    0    0    0    0     0     0     0     0     1     0     0     0     0     0</span></span>
<span><span class="co">#&gt; [3,]    0    0    0    0    0    0    1    0    0     0     0     0     0     0     0     0     1     0     1</span></span>
<span><span class="co">#&gt; [4,]    0    0    1    0    1    0    0    0    0     1     1     1     1     1     1     1     0     1     0</span></span>
<span><span class="co">#&gt; [5,]    0    0    0    0    0    0    0    0    0     1     0     0     0     0     0     1     0     0     0</span></span>
<span><span class="co">#&gt; [6,]    1    1    1    1    1    0    1    1    1     1     1     1     1     1     1     1     1     1     0</span></span>
<span><span class="co">#&gt;      [,20]</span></span>
<span><span class="co">#&gt; [1,]     0</span></span>
<span><span class="co">#&gt; [2,]     0</span></span>
<span><span class="co">#&gt; [3,]     0</span></span>
<span><span class="co">#&gt; [4,]     0</span></span>
<span><span class="co">#&gt; [5,]     0</span></span>
<span><span class="co">#&gt; [6,]     1</span></span></code></pre></div>
<p>CFA and DIF rely on a <span class="math inline">J</span> by <span class="math inline">D</span> binary loading indicator matrix specifying
latent dimensions each item loads on, where <span class="math inline">D</span> is the number of latent dimensions. The
latent traits have <span class="math inline">D=2</span> dimensions
here.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">D2PL_data</span><span class="op">$</span><span class="va">model</span></span>
<span><span class="co">#&gt;       [,1] [,2]</span></span>
<span><span class="co">#&gt;  [1,]    1    0</span></span>
<span><span class="co">#&gt;  [2,]    0    1</span></span>
<span><span class="co">#&gt;  [3,]    1    0</span></span>
<span><span class="co">#&gt;  [4,]    0    1</span></span>
<span><span class="co">#&gt;  [5,]    1    0</span></span>
<span><span class="co">#&gt;  [6,]    0    1</span></span>
<span><span class="co">#&gt;  [7,]    1    0</span></span>
<span><span class="co">#&gt;  [8,]    0    1</span></span>
<span><span class="co">#&gt;  [9,]    1    0</span></span>
<span><span class="co">#&gt; [10,]    0    1</span></span>
<span><span class="co">#&gt; [11,]    1    0</span></span>
<span><span class="co">#&gt; [12,]    0    1</span></span>
<span><span class="co">#&gt; [13,]    1    0</span></span>
<span><span class="co">#&gt; [14,]    0    1</span></span>
<span><span class="co">#&gt; [15,]    1    0</span></span>
<span><span class="co">#&gt; [16,]    0    1</span></span>
<span><span class="co">#&gt; [17,]    1    0</span></span>
<span><span class="co">#&gt; [18,]    0    1</span></span>
<span><span class="co">#&gt; [19,]    1    0</span></span>
<span><span class="co">#&gt; [20,]    0    1</span></span></code></pre></div>
<p>DIF analysis additionally needs an <span class="math inline">N</span>
dimensional group membership vector, whose elements are integers from
<span class="math inline">1</span> to <span class="math inline">G</span>, where <span class="math inline">G</span>
is the number of groups. There are <span class="math inline">G=3</span>
groups in this example.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">D2PL_data</span><span class="op">$</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   1   2   3 </span></span>
<span><span class="co">#&gt; 500 500 500</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-output">Data Output<a class="anchor" aria-label="anchor" href="#data-output"></a>
</h2>
<p>All the functions output estimates of item parameters and some other
related parameters. In addition, <code>C2PL_gvem</code> and
<code>C2PL_bs</code> are able to provide the standard errors of item
parameter estimates.</p>
</div>
<div class="section level2">
<h2 id="exploratory-factor-analysis">Exploratory Factor Analysis<a class="anchor" aria-label="anchor" href="#exploratory-factor-analysis"></a>
</h2>
<div class="section level3">
<h3 id="parallel-analysis">Parallel Analysis<a class="anchor" aria-label="anchor" href="#parallel-analysis"></a>
</h3>
<p>Parallel analysis can be conducted to determine the number of
factors. Users can specify the number of simulated datasets, which takes
<code>n.iter = 10</code> by default.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pa_poly.html">pa_poly</a></span><span class="op">(</span><span class="va">D2PL_data</span><span class="op">$</span><span class="va">data</span>, n.iter <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Parallel analysis suggests that the number of factors =  2</span></span></code></pre></div>
<div class="float">
<img src="figure/unnamed-chunk-6-1.png" alt="plot of chunk unnamed-chunk-6"><div class="figcaption">plot of chunk unnamed-chunk-6</div>
</div>
</div>
<div class="section level3">
<h3 id="m2pl-model">M2PL Model<a class="anchor" aria-label="anchor" href="#m2pl-model"></a>
</h3>
<p><code>VEMIRT</code> provides the following functions to conduct EFA
for the M2PL model:</p>
<table class="table">
<thead><tr class="header">
<th align="center">Function</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><code>E2PL_gvem_rot</code></td>
<td align="center">GVEM with post-doc rotation</td>
</tr>
<tr class="even">
<td align="center"><code>E2PL_gvem_lasso</code></td>
<td align="center">GVEM with lasso penalty</td>
</tr>
<tr class="odd">
<td align="center"><code>E2PL_gvem_adaptlasso</code></td>
<td align="center">GVEM with adaptive lasso penalty</td>
</tr>
<tr class="even">
<td align="center"><code>E2PL_iw</code></td>
<td align="center">GVEM with importance sampling</td>
</tr>
</tbody>
</table>
<p>Currently these functions do not estimate the standard errors of item
parameters. The following examples use two simulated datasets,
<code>E2PL_data_C1</code> and <code>E2PL_data_C2</code>, both having
<span class="math inline">N=1000</span> respondents, <span class="math inline">J=30</span> items and <span class="math inline">D=3</span> dimensions, but items load on different
dimensions.</p>
<p><code>E2PL_gvem_rot</code> needs the item responses and the number of
factors (<code>domain</code>), and applies the promax rotation
(<code>rot = "Promax"</code>) by default. Another choice is
<code>rot = "cfQ"</code>, which performs the CF-Quartimax rotation.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/E2PL_gvem_rot.html">E2PL_gvem_rot</a></span><span class="op">(</span><span class="va">E2PL_data_C1</span><span class="op">$</span><span class="va">data</span>, domain <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;              a1      a2       a3       b</span></span>
<span><span class="co">#&gt; Item1   0.10594  1.5952 -0.10845  1.7290</span></span>
<span><span class="co">#&gt; Item2   1.91968  0.0721 -0.05631 -1.3236</span></span>
<span><span class="co">#&gt; Item3   0.07972 -0.0394  1.56129 -1.2989</span></span>
<span><span class="co">#&gt; Item4   0.19942  1.8727 -0.05273 -0.8808</span></span>
<span><span class="co">#&gt; Item5   1.73784  0.0441 -0.11143 -0.8111</span></span>
<span><span class="co">#&gt; Item6  -0.05117  0.0230  1.63743  0.1912</span></span>
<span><span class="co">#&gt; Item7  -0.05174  1.3707 -0.00506 -0.9726</span></span>
<span><span class="co">#&gt; Item8   1.52949  0.1766 -0.03231  0.4670</span></span>
<span><span class="co">#&gt; Item9  -0.01529  0.0186  1.42425  1.1823</span></span>
<span><span class="co">#&gt; Item10  0.04563  1.4053  0.07149  1.0613</span></span>
<span><span class="co">#&gt; Item11  1.64560 -0.0849  0.06168  0.8636</span></span>
<span><span class="co">#&gt; Item12  0.08978  0.0130  1.65967 -0.6542</span></span>
<span><span class="co">#&gt; Item13  0.10412  1.8613  0.09076  0.0380</span></span>
<span><span class="co">#&gt; Item14  1.42716 -0.1292  0.18454  1.5696</span></span>
<span><span class="co">#&gt; Item15  0.03152  0.0564  1.78979 -1.3211</span></span>
<span><span class="co">#&gt; Item16 -0.03327  1.7001  0.17390 -1.9581</span></span>
<span><span class="co">#&gt; Item17  1.84224 -0.0486 -0.00188  0.5343</span></span>
<span><span class="co">#&gt; Item18 -0.00405 -0.0918  1.60662  0.5123</span></span>
<span><span class="co">#&gt; Item19 -0.19546  1.8230 -0.07211  0.1182</span></span>
<span><span class="co">#&gt; Item20  1.34056 -0.0278  0.07707  0.3125</span></span>
<span><span class="co">#&gt; Item21  0.14051 -0.0800  1.71112  0.1102</span></span>
<span><span class="co">#&gt; Item22 -0.06479  1.9194 -0.02918 -0.6766</span></span>
<span><span class="co">#&gt; Item23  1.55836  0.2900  0.05540  1.0387</span></span>
<span><span class="co">#&gt; Item24 -0.20321  0.1247  1.59738  0.0535</span></span>
<span><span class="co">#&gt; Item25  0.04718  1.4758  0.06536  0.3251</span></span>
<span><span class="co">#&gt; Item26  1.75190 -0.0335  0.07172 -0.0327</span></span>
<span><span class="co">#&gt; Item27  0.11757  0.0217  1.65739  0.5990</span></span>
<span><span class="co">#&gt; Item28  0.00903  1.7688  0.05774 -1.5098</span></span>
<span><span class="co">#&gt; Item29  1.65340 -0.0803  0.04002 -1.0095</span></span>
<span><span class="co">#&gt; Item30 -0.20175  0.0796  1.52666 -0.1739</span></span></code></pre></div>
<p>Both <code>E2PL_gvem_lasso</code> and
<code>E2PL_gvem_adaptlasso</code> need item responses, constraint
setting (<code>constrain</code>), and a binary matrix specifying
constraints on the sub-matrix of the factor loading structure
(<code>indic</code>). <code>constrain</code> should be either
<code>"C1"</code> or <code>"C2"</code> to ensure identifiability. Under
<code>"C1"</code>, a <span class="math inline">D\times D</span>
sub-matrix of <code>indic</code> should be an identity matrix,
indicating that each of these <span class="math inline">D</span> items
loads solely on one factor. Notice that the first 3 rows of
<code>E2PL_data_C1$data</code> form an identity matrix.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">E2PL_data_C1</span><span class="op">$</span><span class="va">model</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt;  [1,]    1    0    0</span></span>
<span><span class="co">#&gt;  [2,]    0    1    0</span></span>
<span><span class="co">#&gt;  [3,]    0    0    1</span></span>
<span><span class="co">#&gt;  [4,]    1    1    1</span></span>
<span><span class="co">#&gt;  [5,]    1    1    1</span></span>
<span><span class="co">#&gt;  [6,]    1    1    1</span></span>
<span><span class="co">#&gt;  [7,]    1    1    1</span></span>
<span><span class="co">#&gt;  [8,]    1    1    1</span></span>
<span><span class="co">#&gt;  [9,]    1    1    1</span></span>
<span><span class="co">#&gt; [10,]    1    1    1</span></span>
<span><span class="co">#&gt; [11,]    1    1    1</span></span>
<span><span class="co">#&gt; [12,]    1    1    1</span></span>
<span><span class="co">#&gt; [13,]    1    1    1</span></span>
<span><span class="co">#&gt; [14,]    1    1    1</span></span>
<span><span class="co">#&gt; [15,]    1    1    1</span></span>
<span><span class="co">#&gt; [16,]    1    1    1</span></span>
<span><span class="co">#&gt; [17,]    1    1    1</span></span>
<span><span class="co">#&gt; [18,]    1    1    1</span></span>
<span><span class="co">#&gt; [19,]    1    1    1</span></span>
<span><span class="co">#&gt; [20,]    1    1    1</span></span>
<span><span class="co">#&gt; [21,]    1    1    1</span></span>
<span><span class="co">#&gt; [22,]    1    1    1</span></span>
<span><span class="co">#&gt; [23,]    1    1    1</span></span>
<span><span class="co">#&gt; [24,]    1    1    1</span></span>
<span><span class="co">#&gt; [25,]    1    1    1</span></span>
<span><span class="co">#&gt; [26,]    1    1    1</span></span>
<span><span class="co">#&gt; [27,]    1    1    1</span></span>
<span><span class="co">#&gt; [28,]    1    1    1</span></span>
<span><span class="co">#&gt; [29,]    1    1    1</span></span>
<span><span class="co">#&gt; [30,]    1    1    1</span></span></code></pre></div>
<p>Under <code>"C2"</code>, a <span class="math inline">D\times D</span>
sub-matrix of <code>indic</code> should be a lower triangular matrix
whose diagonal elements are all one, indicating that each of these <span class="math inline">D</span> items loads on one factor and potentially
other factors as well; non-zero elements other than the diagonal are
penalized. For identification under <code>"C2"</code>, another argument
<code>non_pen</code> should be provided, which specifies an anchor item
that loads on all the factors. In the following example, the first 2
rows and any other row form such a lower triangular matrix, so
<code>non_pen</code> can take any integer from <span class="math inline">3</span> to <span class="math inline">30</span>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">E2PL_data_C2</span><span class="op">$</span><span class="va">model</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt;  [1,]    1    0    0</span></span>
<span><span class="co">#&gt;  [2,]    1    1    0</span></span>
<span><span class="co">#&gt;  [3,]    1    1    1</span></span>
<span><span class="co">#&gt;  [4,]    1    1    1</span></span>
<span><span class="co">#&gt;  [5,]    1    1    1</span></span>
<span><span class="co">#&gt;  [6,]    1    1    1</span></span>
<span><span class="co">#&gt;  [7,]    1    1    1</span></span>
<span><span class="co">#&gt;  [8,]    1    1    1</span></span>
<span><span class="co">#&gt;  [9,]    1    1    1</span></span>
<span><span class="co">#&gt; [10,]    1    1    1</span></span>
<span><span class="co">#&gt; [11,]    1    1    1</span></span>
<span><span class="co">#&gt; [12,]    1    1    1</span></span>
<span><span class="co">#&gt; [13,]    1    1    1</span></span>
<span><span class="co">#&gt; [14,]    1    1    1</span></span>
<span><span class="co">#&gt; [15,]    1    1    1</span></span>
<span><span class="co">#&gt; [16,]    1    1    1</span></span>
<span><span class="co">#&gt; [17,]    1    1    1</span></span>
<span><span class="co">#&gt; [18,]    1    1    1</span></span>
<span><span class="co">#&gt; [19,]    1    1    1</span></span>
<span><span class="co">#&gt; [20,]    1    1    1</span></span>
<span><span class="co">#&gt; [21,]    1    1    1</span></span>
<span><span class="co">#&gt; [22,]    1    1    1</span></span>
<span><span class="co">#&gt; [23,]    1    1    1</span></span>
<span><span class="co">#&gt; [24,]    1    1    1</span></span>
<span><span class="co">#&gt; [25,]    1    1    1</span></span>
<span><span class="co">#&gt; [26,]    1    1    1</span></span>
<span><span class="co">#&gt; [27,]    1    1    1</span></span>
<span><span class="co">#&gt; [28,]    1    1    1</span></span>
<span><span class="co">#&gt; [29,]    1    1    1</span></span>
<span><span class="co">#&gt; [30,]    1    1    1</span></span></code></pre></div>
<p><code>E2PL_gvem_adaptlasso</code> needs an additional tuning
parameter, which takes <code>gamma = 2</code> by default. Users are
referred to <span class="citation">Cho et al. (<a href="#ref-cho2024">2024</a>)</span> for algorithmic details.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">E2PL_data_C1</span>, <span class="fu"><a href="../reference/E2PL_gvem_lasso.html">E2PL_gvem_lasso</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span>, constrain <span class="op">=</span> <span class="st">"C1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt;           a1     a2   a3       b</span></span>
<span><span class="co">#&gt; Item1  1.572  0.000 0.00  1.7198</span></span>
<span><span class="co">#&gt; Item2  0.000  1.923 0.00 -1.3243</span></span>
<span><span class="co">#&gt; Item3  0.000  0.000 1.58 -1.2981</span></span>
<span><span class="co">#&gt; Item4  1.928  0.000 0.00 -0.8756</span></span>
<span><span class="co">#&gt; Item5  0.000  1.696 0.00 -0.8114</span></span>
<span><span class="co">#&gt; Item6  0.000  0.000 1.62  0.1907</span></span>
<span><span class="co">#&gt; Item7  1.337  0.000 0.00 -0.9712</span></span>
<span><span class="co">#&gt; Item8  0.000  1.589 0.00  0.4653</span></span>
<span><span class="co">#&gt; Item9  0.000  0.000 1.42  1.1816</span></span>
<span><span class="co">#&gt; Item10 1.473  0.000 0.00  1.0629</span></span>
<span><span class="co">#&gt; Item11 0.000  1.639 0.00  0.8623</span></span>
<span><span class="co">#&gt; Item12 0.000  0.000 1.71 -0.6524</span></span>
<span><span class="co">#&gt; Item13 1.964  0.000 0.00  0.0408</span></span>
<span><span class="co">#&gt; Item14 0.000  1.459 0.00  1.5628</span></span>
<span><span class="co">#&gt; Item15 0.000  0.000 1.84 -1.3199</span></span>
<span><span class="co">#&gt; Item16 1.776  0.000 0.00 -1.9514</span></span>
<span><span class="co">#&gt; Item17 0.000  1.807 0.00  0.5304</span></span>
<span><span class="co">#&gt; Item18 0.000  0.000 1.55  0.5113</span></span>
<span><span class="co">#&gt; Item19 1.812 -0.277 0.00  0.1169</span></span>
<span><span class="co">#&gt; Item20 0.000  1.367 0.00  0.3120</span></span>
<span><span class="co">#&gt; Item21 0.000  0.000 1.73  0.1104</span></span>
<span><span class="co">#&gt; Item22 1.861  0.000 0.00 -0.6754</span></span>
<span><span class="co">#&gt; Item23 0.322  1.560 0.00  1.0364</span></span>
<span><span class="co">#&gt; Item24 0.000  0.000 1.54  0.0525</span></span>
<span><span class="co">#&gt; Item25 1.544  0.000 0.00  0.3269</span></span>
<span><span class="co">#&gt; Item26 0.000  1.775 0.00 -0.0335</span></span>
<span><span class="co">#&gt; Item27 0.000  0.000 1.74  0.6011</span></span>
<span><span class="co">#&gt; Item28 1.803  0.000 0.00 -1.5078</span></span>
<span><span class="co">#&gt; Item29 0.000  1.633 0.00 -1.0087</span></span>
<span><span class="co">#&gt; Item30 0.000 -0.204 1.57 -0.1730</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">E2PL_data_C2</span>, <span class="fu"><a href="../reference/E2PL_gvem_adaptlasso.html">E2PL_gvem_adaptlasso</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span>, constrain <span class="op">=</span> <span class="st">"C2"</span>, non_pen <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;             a1    a2   a3       b</span></span>
<span><span class="co">#&gt; Item1   1.6019 0.000 0.00  1.7409</span></span>
<span><span class="co">#&gt; Item2   0.4230 2.419 0.00 -1.1530</span></span>
<span><span class="co">#&gt; Item3   0.0000 2.649 1.00 -1.2417</span></span>
<span><span class="co">#&gt; Item4   1.9203 0.000 0.00 -0.8737</span></span>
<span><span class="co">#&gt; Item5  -1.2687 2.575 0.00 -0.8181</span></span>
<span><span class="co">#&gt; Item6  -0.1981 0.988 1.30  0.1904</span></span>
<span><span class="co">#&gt; Item7   1.3404 0.000 0.00 -0.9736</span></span>
<span><span class="co">#&gt; Item8  -0.8955 2.214 0.00  0.4638</span></span>
<span><span class="co">#&gt; Item9  -0.2045 0.908 1.12  1.1810</span></span>
<span><span class="co">#&gt; Item10  1.5077 0.000 0.00  1.0795</span></span>
<span><span class="co">#&gt; Item11 -1.2717 2.493 0.00  0.8623</span></span>
<span><span class="co">#&gt; Item12 -0.3468 1.248 1.32 -0.6612</span></span>
<span><span class="co">#&gt; Item13  2.0240 0.000 0.00  0.0465</span></span>
<span><span class="co">#&gt; Item14 -1.1050 2.213 0.00  1.5660</span></span>
<span><span class="co">#&gt; Item15 -0.2273 1.163 1.39 -1.3111</span></span>
<span><span class="co">#&gt; Item16  1.8359 0.000 0.00 -1.9954</span></span>
<span><span class="co">#&gt; Item17 -1.3386 2.723 0.00  0.5314</span></span>
<span><span class="co">#&gt; Item18 -0.3741 1.035 1.27  0.5081</span></span>
<span><span class="co">#&gt; Item19  1.6743 0.000 0.00  0.1161</span></span>
<span><span class="co">#&gt; Item20 -0.9951 2.069 0.00  0.3137</span></span>
<span><span class="co">#&gt; Item21 -0.4841 1.330 1.34  0.1086</span></span>
<span><span class="co">#&gt; Item22  1.8836 0.000 0.00 -0.6795</span></span>
<span><span class="co">#&gt; Item23 -0.7954 2.335 0.00  1.0436</span></span>
<span><span class="co">#&gt; Item24  0.0000 0.731 1.26  0.0521</span></span>
<span><span class="co">#&gt; Item25  1.5476 0.000 0.00  0.3304</span></span>
<span><span class="co">#&gt; Item26 -1.2496 2.608 0.00 -0.0336</span></span>
<span><span class="co">#&gt; Item27 -0.3240 1.230 1.30  0.5954</span></span>
<span><span class="co">#&gt; Item28  1.8113 0.000 0.00 -1.5157</span></span>
<span><span class="co">#&gt; Item29 -1.2838 2.500 0.00 -1.0119</span></span>
<span><span class="co">#&gt; Item30 -0.0444 0.701 1.23 -0.1758</span></span></code></pre></div>
<p>GVEM is known to produce biased estimates for discrimination
parameters, and <code>E2PL_iw</code> helps reduce the bias through
importance sampling <span class="citation">(<a href="#ref-ma2024">Ma et
al., 2024</a>)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/C2PL_iw.html">E2PL_iw</a></span><span class="op">(</span><span class="va">E2PL_data_C1</span><span class="op">$</span><span class="va">data</span>, <span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt;          a1     a2   a3        b</span></span>
<span><span class="co">#&gt; Item1  1.82  0.000 0.00  1.93892</span></span>
<span><span class="co">#&gt; Item2  0.00  2.176 0.00 -1.51429</span></span>
<span><span class="co">#&gt; Item3  0.00  0.000 1.83 -1.50028</span></span>
<span><span class="co">#&gt; Item4  2.18  0.000 0.00 -1.06272</span></span>
<span><span class="co">#&gt; Item5  0.00  1.943 0.00 -0.95791</span></span>
<span><span class="co">#&gt; Item6  0.00  0.000 1.86  0.24090</span></span>
<span><span class="co">#&gt; Item7  1.57  0.000 0.00 -1.15989</span></span>
<span><span class="co">#&gt; Item8  0.00  1.834 0.00  0.61006</span></span>
<span><span class="co">#&gt; Item9  0.00  0.000 1.66  1.38268</span></span>
<span><span class="co">#&gt; Item10 1.71  0.000 0.00  1.25149</span></span>
<span><span class="co">#&gt; Item11 0.00  1.885 0.00  1.04897</span></span>
<span><span class="co">#&gt; Item12 0.00  0.000 1.96 -0.79208</span></span>
<span><span class="co">#&gt; Item13 2.21  0.000 0.00 -0.00846</span></span>
<span><span class="co">#&gt; Item14 0.00  1.697 0.00  1.78234</span></span>
<span><span class="co">#&gt; Item15 0.00  0.000 2.09 -1.51844</span></span>
<span><span class="co">#&gt; Item16 2.03  0.000 0.00 -2.17690</span></span>
<span><span class="co">#&gt; Item17 0.00  2.057 0.00  0.68606</span></span>
<span><span class="co">#&gt; Item18 0.00  0.000 1.80  0.64290</span></span>
<span><span class="co">#&gt; Item19 2.05 -0.162 0.00  0.10766</span></span>
<span><span class="co">#&gt; Item20 0.00  1.598 0.00  0.42147</span></span>
<span><span class="co">#&gt; Item21 0.00  0.000 1.97  0.13218</span></span>
<span><span class="co">#&gt; Item22 2.11  0.000 0.00 -0.84737</span></span>
<span><span class="co">#&gt; Item23 0.49  1.805 0.00  1.24074</span></span>
<span><span class="co">#&gt; Item24 0.00  0.000 1.78  0.05249</span></span>
<span><span class="co">#&gt; Item25 1.78  0.000 0.00  0.37440</span></span>
<span><span class="co">#&gt; Item26 0.00  2.022 0.00  0.00687</span></span>
<span><span class="co">#&gt; Item27 0.00  0.000 1.99  0.74305</span></span>
<span><span class="co">#&gt; Item28 2.05  0.000 0.00 -1.72294</span></span>
<span><span class="co">#&gt; Item29 0.00  1.880 0.00 -1.18368</span></span>
<span><span class="co">#&gt; Item30 0.00 -0.105 1.81 -0.20663</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="m3pl-model">M3PL Model<a class="anchor" aria-label="anchor" href="#m3pl-model"></a>
</h3>
<p><code>VEMIRT</code> provides the following functions to conduct EFA
for the M3PL model:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th align="center">Function</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><code>E3PL_sgvem_rot</code></td>
<td align="center">Stochastic GVEM with post-doc rotation</td>
</tr>
<tr class="even">
<td align="center"><code>E3PL_sgvem_lasso</code></td>
<td align="center">Stochastic GVEM with lasso penalty</td>
</tr>
<tr class="odd">
<td align="center"><code>E3PL_sgvem_adaptlasso</code></td>
<td align="center">Stochastic GVEM with adaptive lasso penalty</td>
</tr>
</tbody>
</table>
<p>The following examples use two simulated datasets,
<code>E3PL_data_C1</code> and <code>E3PL_data_C2</code>, both having
<span class="math inline">N=1000</span> respondents, <span class="math inline">J=30</span> items and <span class="math inline">D=3</span> dimensions, but items load on different
dimensions.</p>
<p>The usage of these functions is similar to those for M2PL models, but
some additional arguments are required: the size of the subsample for
each iteration (<code>samp = 50</code> by default), the forget rate for
the stochastic algorithm (<code>forgetrate = 0.51</code> by default),
the mean and the variance of the normal distribution as a prior for item
difficulty parameters (<code>mu_b</code> and <code>sigma2_b</code>), the
<span class="math inline">\alpha</span> and <span class="math inline">\beta</span> parameters of the beta distribution as
a prior for guessing parameters (<code>Alpha</code> and
<code>Beta</code>). Still, <code>E3PL_sgvem_adaptlasso</code> needs a
tuning parameter, which takes <code>gamma = 2</code> by default. Users
are referred to <span class="citation">Cho et al. (<a href="#ref-cho2024">2024</a>)</span> for algorithmic details. In the
following examples, the priors for difficulty parameters and guessing
parameters are <span class="math inline">N(0,2^2)</span> and <span class="math inline">\beta(10,40)</span> respectively.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">E3PL_data_C1</span>, <span class="fu"><a href="../reference/E3PL_sgvem_adaptlasso.html">E3PL_sgvem_adaptlasso</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span>, mu_b <span class="op">=</span> <span class="fl">0</span>, sigma2_b <span class="op">=</span> <span class="fl">4</span>, Alpha <span class="op">=</span> <span class="fl">10</span>, Beta <span class="op">=</span> <span class="fl">40</span>, constrain <span class="op">=</span> <span class="st">"C1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The maximum number of EM cycles reached!</span></span>
<span><span class="co">#&gt; Warning: The maximum number of EM cycles reached!</span></span>
<span><span class="co">#&gt;           a1   a2    a3       b     c</span></span>
<span><span class="co">#&gt; Item1  0.824 0.00 0.000  0.2221 0.185</span></span>
<span><span class="co">#&gt; Item2  0.000 1.27 0.000 -1.1569 0.188</span></span>
<span><span class="co">#&gt; Item3  0.000 0.00 1.531 -1.2687 0.187</span></span>
<span><span class="co">#&gt; Item4  1.884 0.00 0.000 -0.6809 0.181</span></span>
<span><span class="co">#&gt; Item5  0.000 1.39 0.000 -0.9603 0.188</span></span>
<span><span class="co">#&gt; Item6  0.000 0.00 1.531  0.0323 0.179</span></span>
<span><span class="co">#&gt; Item7  1.576 0.00 0.000 -0.9503 0.184</span></span>
<span><span class="co">#&gt; Item8  0.000 1.15 0.000  0.2288 0.184</span></span>
<span><span class="co">#&gt; Item9  0.000 0.00 0.981  0.7210 0.178</span></span>
<span><span class="co">#&gt; Item10 1.244 0.00 0.000  0.6862 0.176</span></span>
<span><span class="co">#&gt; Item11 0.000 1.32 0.000  0.8267 0.174</span></span>
<span><span class="co">#&gt; Item12 0.000 0.00 1.302 -0.8383 0.187</span></span>
<span><span class="co">#&gt; Item13 1.937 0.00 0.000  0.5078 0.162</span></span>
<span><span class="co">#&gt; Item14 0.000 1.01 0.000  1.0492 0.176</span></span>
<span><span class="co">#&gt; Item15 0.000 0.00 1.419 -1.1223 0.187</span></span>
<span><span class="co">#&gt; Item16 1.564 0.00 0.000 -1.5017 0.187</span></span>
<span><span class="co">#&gt; Item17 0.000 1.47 0.000  0.2434 0.178</span></span>
<span><span class="co">#&gt; Item18 0.000 0.00 1.151  0.4002 0.179</span></span>
<span><span class="co">#&gt; Item19 1.578 0.00 0.000 -0.1455 0.178</span></span>
<span><span class="co">#&gt; Item20 0.000 1.12 0.000  0.2213 0.184</span></span>
<span><span class="co">#&gt; Item21 0.000 0.00 1.577  0.0950 0.174</span></span>
<span><span class="co">#&gt; Item22 1.866 0.00 0.000 -0.4013 0.177</span></span>
<span><span class="co">#&gt; Item23 0.000 1.23 0.000  0.9747 0.179</span></span>
<span><span class="co">#&gt; Item24 0.000 0.00 1.189 -0.5513 0.186</span></span>
<span><span class="co">#&gt; Item25 1.503 0.00 0.000  0.2557 0.177</span></span>
<span><span class="co">#&gt; Item26 0.000 1.30 0.000  0.2660 0.183</span></span>
<span><span class="co">#&gt; Item27 0.000 0.00 1.217  0.0448 0.182</span></span>
<span><span class="co">#&gt; Item28 1.498 0.00 0.000 -1.1697 0.187</span></span>
<span><span class="co">#&gt; Item29 0.000 1.20 0.000 -0.8706 0.187</span></span>
<span><span class="co">#&gt; Item30 0.000 0.00 1.244 -0.2850 0.184</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">E3PL_data_C2</span>, <span class="fu"><a href="../reference/E3PL_sgvem_lasso.html">E3PL_sgvem_lasso</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span>, mu_b <span class="op">=</span> <span class="fl">0</span>, sigma2_b <span class="op">=</span> <span class="fl">4</span>, Alpha <span class="op">=</span> <span class="fl">10</span>, Beta <span class="op">=</span> <span class="fl">40</span>, constrain <span class="op">=</span> <span class="st">"C2"</span>, non_pen <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           a1     a2    a3       b     c</span></span>
<span><span class="co">#&gt; Item1  0.716 0.0000 0.000  0.1848 0.184</span></span>
<span><span class="co">#&gt; Item2  0.000 1.6328 0.000 -1.2424 0.184</span></span>
<span><span class="co">#&gt; Item3  0.000 0.0000 1.737 -1.0087 0.179</span></span>
<span><span class="co">#&gt; Item4  1.336 0.5179 0.000 -0.7203 0.182</span></span>
<span><span class="co">#&gt; Item5  0.000 1.4377 0.000 -0.9989 0.185</span></span>
<span><span class="co">#&gt; Item6  0.000 0.0000 1.288  0.0595 0.180</span></span>
<span><span class="co">#&gt; Item7  1.113 0.4590 0.000 -0.9681 0.184</span></span>
<span><span class="co">#&gt; Item8  0.000 1.2972 0.000  0.1770 0.179</span></span>
<span><span class="co">#&gt; Item9  0.000 0.0000 0.896  0.7047 0.178</span></span>
<span><span class="co">#&gt; Item10 0.931 0.2317 0.000  0.6889 0.176</span></span>
<span><span class="co">#&gt; Item11 0.000 1.4404 0.000  0.7989 0.168</span></span>
<span><span class="co">#&gt; Item12 0.000 0.0000 1.203 -0.8368 0.186</span></span>
<span><span class="co">#&gt; Item13 1.377 0.5979 0.000  0.5104 0.163</span></span>
<span><span class="co">#&gt; Item14 0.000 0.9938 0.000  1.0340 0.172</span></span>
<span><span class="co">#&gt; Item15 0.000 0.0000 1.283 -1.1360 0.187</span></span>
<span><span class="co">#&gt; Item16 1.057 0.5547 0.000 -1.5126 0.187</span></span>
<span><span class="co">#&gt; Item17 0.000 1.5168 0.000  0.1848 0.172</span></span>
<span><span class="co">#&gt; Item18 0.000 0.1215 0.954  0.4423 0.178</span></span>
<span><span class="co">#&gt; Item19 1.096 0.4350 0.000 -0.1511 0.179</span></span>
<span><span class="co">#&gt; Item20 0.000 1.1924 0.000  0.2106 0.180</span></span>
<span><span class="co">#&gt; Item21 0.000 0.0000 1.329  0.1301 0.174</span></span>
<span><span class="co">#&gt; Item22 1.336 0.4624 0.000 -0.3802 0.177</span></span>
<span><span class="co">#&gt; Item23 0.000 1.2371 0.000  0.9373 0.173</span></span>
<span><span class="co">#&gt; Item24 0.000 0.0000 1.057 -0.5256 0.186</span></span>
<span><span class="co">#&gt; Item25 1.155 0.2704 0.000  0.2513 0.175</span></span>
<span><span class="co">#&gt; Item26 0.000 1.3993 0.000  0.2171 0.176</span></span>
<span><span class="co">#&gt; Item27 0.000 0.0558 1.073  0.0427 0.183</span></span>
<span><span class="co">#&gt; Item28 1.182 0.2371 0.000 -1.2105 0.186</span></span>
<span><span class="co">#&gt; Item29 0.000 1.2586 0.000 -0.9502 0.185</span></span>
<span><span class="co">#&gt; Item30 0.000 0.0000 1.040 -0.2977 0.185</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="confirmatory-factor-analysis">Confirmatory Factor Analysis<a class="anchor" aria-label="anchor" href="#confirmatory-factor-analysis"></a>
</h2>
<div class="section level3">
<h3 id="m2pl-model-1">M2PL Model<a class="anchor" aria-label="anchor" href="#m2pl-model-1"></a>
</h3>
<p><code>VEMIRT</code> provides the following functions to conduct CFA
for the M2PL model:</p>
<table class="table">
<thead><tr class="header">
<th align="center">Function</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><code>C2PL_gvem</code></td>
<td align="center">GVEM</td>
</tr>
<tr class="even">
<td align="center"><code>C2PL_bs</code></td>
<td align="center">GVEM with bootstrap</td>
</tr>
<tr class="odd">
<td align="center"><code>C2PL_iw</code></td>
<td align="center">GVEM with importance sampling</td>
</tr>
</tbody>
</table>
<p>A binary loading indicator matrix needs to be provided for CFA.
<code>C2PL_gvem</code> can produce biased estimates while the other two
functions help reduce the bias. Also, only <code>C2PL_gvem</code> and
<code>C2PL_bs</code> are able to provide the standard errors of item
parameters. Users are referred to <span class="citation">Cho et al. (<a href="#ref-cho2021">2021</a>)</span> for <code>C2PL_gvem</code> and
<span class="citation">Ma et al. (<a href="#ref-ma2024">2024</a>)</span>
for <code>C2PL_iw</code>.</p>
<p>The following examples use a simulated dataset,
<code>C2PL_data</code>, which has <span class="math inline">N=1000</span> respondents, <span class="math inline">J=20</span> items and <span class="math inline">D=2</span> dimensions.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">C2PL_data</span>, <span class="fu"><a href="../reference/C2PL_gvem.html">C2PL_gvem</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt;          a1   a2       b</span></span>
<span><span class="co">#&gt; Item1  1.91 0.00  0.8789</span></span>
<span><span class="co">#&gt; Item2  0.00 1.71 -2.1325</span></span>
<span><span class="co">#&gt; Item3  1.85 0.00  0.4760</span></span>
<span><span class="co">#&gt; Item4  0.00 2.03 -1.2061</span></span>
<span><span class="co">#&gt; Item5  1.89 0.00 -0.6088</span></span>
<span><span class="co">#&gt; Item6  0.00 1.57  1.1850</span></span>
<span><span class="co">#&gt; Item7  1.46 0.00 -1.8576</span></span>
<span><span class="co">#&gt; Item8  0.00 1.79 -0.3041</span></span>
<span><span class="co">#&gt; Item9  1.40 0.00  0.3218</span></span>
<span><span class="co">#&gt; Item10 0.00 1.49 -0.4536</span></span>
<span><span class="co">#&gt; Item11 1.89 0.00 -0.3825</span></span>
<span><span class="co">#&gt; Item12 0.00 1.71 -0.1322</span></span>
<span><span class="co">#&gt; Item13 1.36 0.00  0.5896</span></span>
<span><span class="co">#&gt; Item14 0.00 1.43 -2.1947</span></span>
<span><span class="co">#&gt; Item15 1.80 0.00  0.0357</span></span>
<span><span class="co">#&gt; Item16 0.00 1.51  0.9673</span></span>
<span><span class="co">#&gt; Item17 1.97 0.00  0.1262</span></span>
<span><span class="co">#&gt; Item18 0.00 1.68  0.5347</span></span>
<span><span class="co">#&gt; Item19 1.81 0.00 -0.7190</span></span>
<span><span class="co">#&gt; Item20 0.00 1.62 -1.4178</span></span>
<span><span class="fu"><a href="../reference/C2PL_bs.html">C2PL_bs</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt;          a1   a2       b</span></span>
<span><span class="co">#&gt; Item1  2.19 0.00  0.9542</span></span>
<span><span class="co">#&gt; Item2  0.00 2.05 -2.3435</span></span>
<span><span class="co">#&gt; Item3  2.09 0.00  0.5665</span></span>
<span><span class="co">#&gt; Item4  0.00 2.38 -1.3555</span></span>
<span><span class="co">#&gt; Item5  2.22 0.00 -0.6731</span></span>
<span><span class="co">#&gt; Item6  0.00 1.66  1.2325</span></span>
<span><span class="co">#&gt; Item7  1.62 0.00 -1.9500</span></span>
<span><span class="co">#&gt; Item8  0.00 2.00 -0.3105</span></span>
<span><span class="co">#&gt; Item9  1.51 0.00  0.3396</span></span>
<span><span class="co">#&gt; Item10 0.00 1.63 -0.4173</span></span>
<span><span class="co">#&gt; Item11 2.21 0.00 -0.4012</span></span>
<span><span class="co">#&gt; Item12 0.00 1.86 -0.1082</span></span>
<span><span class="co">#&gt; Item13 1.43 0.00  0.5435</span></span>
<span><span class="co">#&gt; Item14 0.00 1.52 -2.3258</span></span>
<span><span class="co">#&gt; Item15 2.07 0.00  0.0380</span></span>
<span><span class="co">#&gt; Item16 0.00 1.64  1.0678</span></span>
<span><span class="co">#&gt; Item17 2.33 0.00  0.0801</span></span>
<span><span class="co">#&gt; Item18 0.00 1.88  0.5184</span></span>
<span><span class="co">#&gt; Item19 2.09 0.00 -0.8113</span></span>
<span><span class="co">#&gt; Item20 0.00 1.79 -1.4681</span></span>
<span><span class="fu"><a href="../reference/C2PL_iw.html">C2PL_iw</a></span><span class="op">(</span><span class="va">C2PL_data</span><span class="op">$</span><span class="va">data</span>, <span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt;          a1   a2       b</span></span>
<span><span class="co">#&gt; Item1  2.16 0.00  1.0352</span></span>
<span><span class="co">#&gt; Item2  0.00 1.96 -2.3604</span></span>
<span><span class="co">#&gt; Item3  2.09 0.00  0.5737</span></span>
<span><span class="co">#&gt; Item4  0.00 2.28 -1.4103</span></span>
<span><span class="co">#&gt; Item5  2.14 0.00 -0.7289</span></span>
<span><span class="co">#&gt; Item6  0.00 1.80  1.3748</span></span>
<span><span class="co">#&gt; Item7  1.70 0.00 -2.0733</span></span>
<span><span class="co">#&gt; Item8  0.00 2.03 -0.4369</span></span>
<span><span class="co">#&gt; Item9  1.63 0.00  0.3934</span></span>
<span><span class="co">#&gt; Item10 0.00 1.72 -0.5925</span></span>
<span><span class="co">#&gt; Item11 2.14 0.00 -0.4616</span></span>
<span><span class="co">#&gt; Item12 0.00 1.95 -0.2265</span></span>
<span><span class="co">#&gt; Item13 1.58 0.00  0.7169</span></span>
<span><span class="co">#&gt; Item14 0.00 1.67 -2.4219</span></span>
<span><span class="co">#&gt; Item15 2.05 0.00  0.0132</span></span>
<span><span class="co">#&gt; Item16 0.00 1.74  1.1379</span></span>
<span><span class="co">#&gt; Item17 2.22 0.00  0.1296</span></span>
<span><span class="co">#&gt; Item18 0.00 1.92  0.6167</span></span>
<span><span class="co">#&gt; Item19 2.06 0.00 -0.8566</span></span>
<span><span class="co">#&gt; Item20 0.00 1.86 -1.6292</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="m3pl-model-1">M3PL Model<a class="anchor" aria-label="anchor" href="#m3pl-model-1"></a>
</h3>
<p><code>C3PL_sgvem</code> conducts CFA for M3PL models. Its usage is
similar to that of <code>E3PL_sgvem_*</code> except that a binary
loading indicator matrix is needed additionally. Users are referred to
<span class="citation">Cho et al. (<a href="#ref-cho2021">2021</a>)</span> for algorithmic details.</p>
<p>The following example uses a simulated dataset,
<code>C3PL_data</code>, which has <span class="math inline">N=2000</span> respondents, <span class="math inline">J=20</span> items and <span class="math inline">D=2</span> dimensions. The priors for difficulty
parameters and guessing parameters are chosen to be <span class="math inline">N(0,2^2)</span> and <span class="math inline">\beta(10,40)</span> respectively.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">C3PL_data</span>, <span class="fu"><a href="../reference/C3PL_sgvem.html">C3PL_sgvem</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span>, mu_b <span class="op">=</span> <span class="fl">0</span>, sigma2_b <span class="op">=</span> <span class="fl">4</span>, Alpha <span class="op">=</span> <span class="fl">10</span>, Beta <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          a1    a2       b     c</span></span>
<span><span class="co">#&gt; Item1  1.16 0.000 -0.1003 0.185</span></span>
<span><span class="co">#&gt; Item2  0.00 1.433  1.5776 0.152</span></span>
<span><span class="co">#&gt; Item3  1.80 0.000 -0.5373 0.179</span></span>
<span><span class="co">#&gt; Item4  0.00 1.557 -1.4996 0.187</span></span>
<span><span class="co">#&gt; Item5  1.46 0.000 -1.6942 0.188</span></span>
<span><span class="co">#&gt; Item6  0.00 1.409  1.6327 0.155</span></span>
<span><span class="co">#&gt; Item7  1.29 0.000 -0.6398 0.185</span></span>
<span><span class="co">#&gt; Item8  0.00 1.395  0.0948 0.179</span></span>
<span><span class="co">#&gt; Item9  1.70 0.000  0.6206 0.170</span></span>
<span><span class="co">#&gt; Item10 0.00 1.430 -0.0898 0.181</span></span>
<span><span class="co">#&gt; Item11 1.22 0.000  0.5128 0.175</span></span>
<span><span class="co">#&gt; Item12 0.00 0.955  1.3418 0.173</span></span>
<span><span class="co">#&gt; Item13 1.46 0.000  1.4928 0.159</span></span>
<span><span class="co">#&gt; Item14 0.00 1.202  0.8414 0.175</span></span>
<span><span class="co">#&gt; Item15 1.24 0.000 -0.0937 0.183</span></span>
<span><span class="co">#&gt; Item16 0.00 1.511  0.6968 0.168</span></span>
<span><span class="co">#&gt; Item17 1.43 0.000 -0.4500 0.182</span></span>
<span><span class="co">#&gt; Item18 0.00 1.758 -1.2304 0.182</span></span>
<span><span class="co">#&gt; Item19 1.01 0.000  1.0262 0.175</span></span>
<span><span class="co">#&gt; Item20 0.00 1.139 -0.7983 0.188</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="differential-item-functioning">Differential Item Functioning<a class="anchor" aria-label="anchor" href="#differential-item-functioning"></a>
</h2>
<p><code>VEMIRT</code> provides the following functions to detect DIF
for the M2PL model:</p>
<table class="table">
<thead><tr class="header">
<th align="center">Function</th>
<th align="center">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><code>D2PL_lrt</code></td>
<td align="center">Likelihood Ratio Test</td>
</tr>
<tr class="even">
<td align="center"><code>D2PL_em</code></td>
<td align="center">EM with lasso penalty</td>
</tr>
<tr class="odd">
<td align="center"><code>D2PL_gvem</code></td>
<td align="center">GVEM with lasso penalty</td>
</tr>
</tbody>
</table>
<p>We recommend <code>D2PL_em</code> for low-dimensional cases (e.g.,
<span class="math inline">D\leq 3</span>) because it is more accurate;
<code>D2PL_gvem</code> is recommend for high-dimensional cases and/or
fast estimation. Both functions require item responses, loading
indicator, and group membership. Besides, estimation method
(<code>method</code>) and tuning parameter vector (<code>Lambda0</code>)
are the two most important arguments. <code>IWGVEMM</code> is the
default choice and is recommended for <code>D2PL_gvem</code> because
this method has an additional importance sampling step which helps
improve accuracy. We do not recommend <code>D2PL_lrt</code> because it
is time-consuming. Users are referred to <span class="citation">Wang et
al. (<a href="#ref-wang2023">2023</a>)</span> for
<code>D2PL_em</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">D2PL_data</span>, <span class="fu"><a href="../reference/D2PL_gvem.html">D2PL_gvem</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span>, <span class="va">group</span>, method <span class="op">=</span> <span class="st">'IWGVEMM'</span>, Lambda0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.7</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt;      1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20</span></span>
<span><span class="co">#&gt; 2:a1                                                   </span></span>
<span><span class="co">#&gt; 2:a2                                                   </span></span>
<span><span class="co">#&gt; 2:b          X                                         </span></span>
<span><span class="co">#&gt; 3:a1                                                   </span></span>
<span><span class="co">#&gt; 3:a2       X                                           </span></span>
<span><span class="co">#&gt; 3:b  X X X X X X                                       </span></span>
<span><span class="co">#&gt; * lambda0 = 0.5</span></span></code></pre></div>
<p>Item parameters are ordered by groups and group 1 is the reference
group. DIF items are flagged by <code>X</code>. By default,
<code>D2PL_gvem</code> chooses the best tuning parameter using the
generalized information criterion (GIC), and in this example 0.5 is
chosen, but AIC and BIC can be used too.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">'AIC'</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in check.vemirt_DIF(all, fit, "lambda0"): Optimal lambda0 may be less than 0.2.</span></span>
<span><span class="co">#&gt;      1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20</span></span>
<span><span class="co">#&gt; 2:a1                                                   </span></span>
<span><span class="co">#&gt; 2:a2                                                   </span></span>
<span><span class="co">#&gt; 2:b  X X   X X   X   X  X              X  X     X      </span></span>
<span><span class="co">#&gt; 3:a1 X   X   X       X                                 </span></span>
<span><span class="co">#&gt; 3:a2   X   X   X                                       </span></span>
<span><span class="co">#&gt; 3:b  X X X X X X   X X                          X      </span></span>
<span><span class="co">#&gt; * lambda0 = 0.2</span></span></code></pre></div>
<p>The message warns us that the optimal tuning parameter may be out of
the range specified for estimation. Users should specify a wider range
for the argument <code>Lambda0</code> if the current information
criterion is used. Finally, other parameter estimates can be obtained
too:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">'BIC'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 17</span></span>
<span><span class="co">#&gt;  $ lambda0: num 0.4</span></span>
<span><span class="co">#&gt;  $ lambda : num 15.5</span></span>
<span><span class="co">#&gt;  $ niter  : num [1:2] 108 100</span></span>
<span><span class="co">#&gt;  $ ll     : num -11577</span></span>
<span><span class="co">#&gt;  $ l0     : int 12</span></span>
<span><span class="co">#&gt;  $ SIGMA  : num [1:1500, 1:2, 1:2] 0.103 0.124 0.116 0.103 0.13 ...</span></span>
<span><span class="co">#&gt;  $ MU     : num [1:1500, 1:2] 0.00366 -1.21956 -0.86532 0.05182 -1.44339 ...</span></span>
<span><span class="co">#&gt;  $ Sigma  : num [1:3, 1:2, 1:2] 1 0.979 1.007 0.834 0.814 ...</span></span>
<span><span class="co">#&gt;  $ Mu     : num [1:3, 1:2] 0 -0.0152 0.0842 0 -0.1347 ...</span></span>
<span><span class="co">#&gt;  $ a      : num [1:20, 1:2] 2.31 0 2.13 0 1.95 ...</span></span>
<span><span class="co">#&gt;  $ b      : num [1:20] 1.0515 0.6607 0.0834 0.82 -0.1187 ...</span></span>
<span><span class="co">#&gt;  $ gamma  : num [1:3, 1:20, 1:2] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ beta   : num [1:3, 1:20] 0 0 0.862 0 0.659 ...</span></span>
<span><span class="co">#&gt;  $ RMSE   : num 0.015</span></span>
<span><span class="co">#&gt;  $ AIC    : num 23177</span></span>
<span><span class="co">#&gt;  $ BIC    : num 23241</span></span>
<span><span class="co">#&gt;  $ GIC    : num 23328</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="package-evaluation">Package Evaluation<a class="anchor" aria-label="anchor" href="#package-evaluation"></a>
</h2>
<p>Here we show two examples on how to test the <code>VEMIRT</code>
package by simulating data, estimating the model using
<code>VEMIRT</code>, and then checking accuracy.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">abind</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">mvtnorm</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="confirmatory-2pl-model">Confirmatory 2PL Model<a class="anchor" aria-label="anchor" href="#confirmatory-2pl-model"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.85</span>, <span class="fl">0.85</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">0</span>, <span class="va">J</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="va">J</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">J</span> <span class="op">*</span> <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">model</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, <span class="va">Sigma</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="va">J</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">a</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span> <span class="op">-</span> <span class="va">b</span><span class="op">)</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">J</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result.gvem</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/C2PL_gvem.html">C2PL_gvem</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span><span class="op">)</span></span>
<span><span class="va">result.iw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/C2PL_iw.html">C2PL_iw</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">result.gvem</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu">rmse</span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">model</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">result.gvem</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">[</span><span class="va">model</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu">rmse</span><span class="op">(</span><span class="va">b</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">result.gvem</span><span class="op">)</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;         a         b </span></span>
<span><span class="co">#&gt; 0.6039514 0.1318309</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu">rmse</span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">model</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">result.iw</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">[</span><span class="va">model</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, b <span class="op">=</span> <span class="fu">rmse</span><span class="op">(</span><span class="va">b</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">result.iw</span><span class="op">)</span><span class="op">$</span><span class="va">b</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          a          b </span></span>
<span><span class="co">#&gt; 0.40411993 0.09705373</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dif-2pl-model">DIF 2PL Model<a class="anchor" aria-label="anchor" href="#dif-2pl-model"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.85</span>, <span class="fl">0.85</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">j</span> <span class="op">&lt;-</span> <span class="va">J</span> <span class="op">*</span> <span class="fl">0.4</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, each <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">0</span>, <span class="va">J</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="va">J</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">J</span> <span class="op">*</span> <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">model</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/abind/man/abind.html" class="external-link">abind</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">a</span>, <span class="va">a</span>, along <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">a</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">j</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">j</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="va">a</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">(</span><span class="va">j</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">j</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">(</span><span class="va">j</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">j</span>, <span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="va">a</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, , <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, , <span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/abind/man/abind.html" class="external-link">abind</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">model</span>, along <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">J</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">b</span>, <span class="va">b</span>, <span class="va">b</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">b</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">j</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">j</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">b</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">(</span><span class="va">j</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span>, <span class="op">(</span><span class="va">j</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">j</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, <span class="va">Sigma</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">*</span> <span class="fl">3</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">J</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">group</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>, , <span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">theta</span><span class="op">[</span><span class="va">n</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">b</span><span class="op">[</span><span class="va">group</span><span class="op">[</span><span class="va">n</span><span class="op">]</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result.iw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/D2PL_gvem.html">D2PL_gvem</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span>, <span class="va">group</span>, verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">result.iw.gic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result.iw</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result.iw.bic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result.iw</span>, <span class="st">'BIC'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">count</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">j</span>, <span class="va">result</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`True Positive` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pos</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>, `False Positive` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pos</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">j</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">count</span><span class="op">(</span><span class="va">j</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">result.iw.gic</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  True Positive False Positive </span></span>
<span><span class="co">#&gt;           0.75           0.00</span></span>
<span><span class="fu">count</span><span class="op">(</span><span class="va">j</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">result.iw.bic</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  True Positive False Positive </span></span>
<span><span class="co">#&gt;      1.0000000      0.1666667</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-cho2021" class="csl-entry">
Cho, A. E., Wang, C., Zhang, X., &amp; Xu, G. (2021). Gaussian
variational estimation for multidimensional item response theory.
<em>British Journal of Mathematical and Statistical Psychology</em>,
<em>74</em>(S1), 52â€“85. <a href="https://doi.org/10.1111/bmsp.12219" class="external-link">https://doi.org/10.1111/bmsp.12219</a>
</div>
<div id="ref-cho2024" class="csl-entry">
Cho, A. E., Xiao, J., Wang, C., &amp; Xu, G. (2024). Regularized
variational estimation for exploratory item factor analysis.
<em>Psychometrika</em>, <em>89</em>(1), 347â€“375. <a href="https://doi.org/10.1007/s11336-022-09874-6" class="external-link">https://doi.org/10.1007/s11336-022-09874-6</a>
</div>
<div id="ref-ma2024" class="csl-entry">
Ma, C., Ouyang, J., Wang, C., &amp; Xu, G. (2024). A note on improving
variational estimation for multidimensional item response theory.
<em>Psychometrika</em>, <em>89</em>(1), 172â€“204. <a href="https://doi.org/10.1007/s11336-023-09939-0" class="external-link">https://doi.org/10.1007/s11336-023-09939-0</a>
</div>
<div id="ref-wang2023" class="csl-entry">
Wang, C., Zhu, R., &amp; Xu, G. (2023). Using lasso and adaptive lasso
to identify <span>DIF</span> in multidimensional <span>2PL</span>
models. <em>Multivariate Behavioral Research</em>, <em>58</em>(2),
387â€“407. <a href="https://doi.org/10.1080/00273171.2021.1985950" class="external-link">https://doi.org/10.1080/00273171.2021.1985950</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weicong Lyu, Jiaying Xiao, Ruoyi Zhu, Gongjun Xu, Chun Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Acknowledgement: This project is supported by IES 305D200015.</p>
</div>

    </footer>
</div>





  </body>
</html>
